<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Mã hoá Vigenere</title>
	<style>
		body {
		  font-size: 16px;
		  margin: 0;
		  padding: 0;
		  font-family: "Consolas", monospace;
		  background: radial-gradient(circle at top, #050505, #000);
		  color: #c8f7ff;
		}

		#thong-tin {
		  text-align: center;
		  padding: 20px;
		  border-bottom: 1px solid #333;
		  background: linear-gradient(to right, #080808, #141414);
		  box-shadow: 0 0 20px #9f00ff55, 0 0 40px #00ffe055 inset;
		}
		#thong-tin h1 {
		  color: #a64dff;
		  text-shadow: 0 0 10px #a64dff, 0 0 25px #7a00ff;
		}

		#chi-tiet {
		  display: flex;
		  min-height: calc(100vh - 120px);
		}
		#chi-tiet > div {
		  width: 50%;
		  padding: 20px;
		  background: rgba(15, 15, 15, 0.95);
		  backdrop-filter: blur(6px);
		}
		#ma-hoa {
		  border-right: 1px solid #333;
		}

		#chi-tiet h2 {
		  color: #00ffe0;
		  border-bottom: 2px solid #a64dff;
		  padding-bottom: 8px;
		  text-shadow: 0 0 8px #00ffe0aa;
		}
		#chi-tiet h3 {
		  color: #ff5c8a;
		  text-shadow: 0 0 8px #ff5c8a55;
		}

		textarea, input {
		  width: 90%;
		  margin: 8px 0;
		  padding: 10px;
		  background: #0d0d0d;
		  border: 1px solid #333;
		  border-radius: 6px;
		  color: #00ffe0;
		  font-size: 1em;
		  resize: none;
		  outline: none;
		  transition: all 0.3s ease;
		}
		textarea:focus, input:focus {
		  border-color: #a64dff;
		  box-shadow: 0 0 10px #a64dff;
		}

		button {
		  background: linear-gradient(135deg, #2d2d2d, #1a1a1a);
		  color: white;
		  border: 2px solid #ff5c8a;
		  padding: 0.6em 1.2em;
		  font-size: 1.1em;
		  cursor: pointer;
		  border-radius: 8px;
		  transition: all 0.3s ease, transform 0.2s;
		  margin-right: 8px;
		  margin-top: 10px;
		}
		button:hover {
		  background: #ff5c8a;
		  color: #fff;
		  transform: translateY(-2px) scale(1.05);
		  box-shadow: 0 0 15px #ff5c8a;
		}

		#chi-tiet p {
		  color: #eee;
		  font-size: 0.95em;
		  margin: 5px 0;
		  background: rgba(166, 77, 255, 0.05);
		  padding: 6px;
		  border-radius: 4px;
		  white-space: pre-wrap;
		}

		.ban-ro-thuc-su, .ma-hoa {
		  color: #0f0;
		  font-weight: bold;
		  text-shadow: 0 0 6px #00ff00, 0 0 12px #00ff0044;
		}
	</style>
</head>
<body>
	<div id="thong-tin">
		<h1>Phương pháp mã hoá Vigenere</h1>
		<p>Mô tả: Mã hóa Vigenère cải tiến từ Caesar bằng cách dùng nhiều khóa dịch chuyển khác nhau, lặp lại theo độ dài từ khóa.</p>
	</div>
	<div id="chi-tiet">
    <div id="ma-hoa">
		<h2>Mã hoá</h2>
		<div>
			<h3>Demo</h3>
			<label>Nhập bản rõ:</label><br>
			<textarea class="ban-ro"></textarea><br>
			<label>Nhập khoá k:</label><br>
			<input class="khoa-k" type="text">
		</div>
		<button>Mã hoá</button>
		<div>
			<h3>Results</h3>
			<p class="so-hoa-ban-ro"></p>
			<p class="so-hoa-k"></p>
			<p class="ma-hoa"></p>
		</div>
    </div>
    <div id="giai-ma">
		<h2>Giải mã</h2>
		<div>
			<h3>Demo</h3>
			<label>Nhập bản mã hoá:</label><br>
			<textarea class="ban-ma"></textarea><br>
			<label>Nhập khoá k:</label><br>
			<input class="khoa-k" type="text">
		</div>
		<button>Giải mã</button>
		<div>
			<h3>Results</h3>
			<p class="so-hoa-ban-ma"></p>
			<p class="so-hoa-k"></p>
			<p class="ban-ro-thuc-su"></p>
		</div>
		</div>
	</div>
	<script>
		const ma_hoa_btn = document.querySelector('#ma-hoa button')
		const giai_ma_btn = document.querySelector('#giai-ma button')
		const hack_btn = document.querySelector('#giai-ma .hack')

		let bang_ma_anh = "";
		for (let i = 0; i < 256; i++) {
			bang_ma_anh += String.fromCharCode(i);
		}
		let so_hoa, result;
		const N = bang_ma_anh.length;

		// ===== Mã hoá =====
		ma_hoa_btn.onclick = function(){
			so_hoa = [], result = [];
			let add_k = [];
			const ban_ro = document.querySelector('#ma-hoa div .ban-ro').value
			const k = document.querySelector('#ma-hoa div .khoa-k').value
			if (ban_ro === "" || k === "") return;
			function getKeyArray(k) {
				return k.split("").map(ch => bang_ma_anh.indexOf(ch));
			}
			const so_hoa_ban_ro = document.querySelector('#ma-hoa div .so-hoa-ban-ro')
			const so_hoa_k = document.querySelector('#ma-hoa div .so-hoa-k')
			const ma_hoa = document.querySelector('#ma-hoa div .ma-hoa')

			const keyArr = getKeyArray(k);
			so_hoa_ban_ro.innerHTML = "Số hoá bản rõ: ";
			so_hoa_k.innerHTML = "Số hoá +k: ";
			ma_hoa.innerHTML = "Bản mã ==> ";

			for (let i = 0; i < ban_ro.length; i++) {
				const code = bang_ma_anh.indexOf(ban_ro[i]);
				so_hoa.push(code);
				const shifted = (code + keyArr[i % keyArr.length]) % N;
				result.push(bang_ma_anh[shifted]);
				so_hoa_ban_ro.innerHTML += " " + code;
				so_hoa_k.innerHTML += " " + shifted;
				ma_hoa.innerHTML += bang_ma_anh[shifted];
			}
		}

		// ===== Giải mã =====
		giai_ma_btn.onclick = function(){
			so_hoa = [], result = [];
			let sub_k = [];
			const ban_ma = document.querySelector('#giai-ma div .ban-ma').value
			const k = document.querySelector('#giai-ma div .khoa-k').value
			if (ban_ma === "" || k === "") return;
			function getKeyArray(k) {
				return k.split("").map(ch => bang_ma_anh.indexOf(ch));
			}
			const so_hoa_ban_ma = document.querySelector('#giai-ma div .so-hoa-ban-ma')
			const so_hoa_k = document.querySelector('#giai-ma div .so-hoa-k')
			const ban_ro_thuc_su = document.querySelector('#giai-ma div .ban-ro-thuc-su')
			const keyArr = getKeyArray(k);
			so_hoa_ban_ma.innerHTML = "Số hoá bản mã: ";
			so_hoa_k.innerHTML = "Số hoá -k: ";
			ban_ro_thuc_su.innerHTML = "Bản rõ ==> ";

			for (let i = 0; i < ban_ma.length; i++) {
				const code = bang_ma_anh.indexOf(ban_ma[i]);
				so_hoa.push(code);
				const shifted = (code - keyArr[i % keyArr.length] + N) % N;
				result.push(bang_ma_anh[shifted]);
				so_hoa_ban_ma.innerHTML += " " + code;
				so_hoa_k.innerHTML += " " + shifted;
				ban_ro_thuc_su.innerHTML += bang_ma_anh[shifted];
			}
		}
	</script>
</body>
</html>
